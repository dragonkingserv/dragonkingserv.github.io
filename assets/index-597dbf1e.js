import{T as f,s as c,E as a,D as A,F as g,p as k,f as u}from"./tab-600127bd.js";import{_ as T,a as y,o as h,c as m,d as b,b as t,t as o,F as x,i as E,j as C,v as D,g as U,n as N}from"./index-aad8881c.js";const _=[{key:1,value:"500U"},{key:2,value:"1000U"}],S={data(){return{actions:_,menu:_[0].key,value:_[0].value,poolUSDT:0,needApprove:!0,needAmount:0,canTakeAmount:0,leftTakeAmount:0,transferAddress:""}},components:{Tab:f},computed:{},methods:{menuChange(e,s){this.menu=e,this.value=s,this.init()},check(){window.location.href="https://bscscan.com/address/0xd6eeA64D7CB614a57383639747b5B37C74aa3894"},async pledge(){if(this.poolUSDT==0){c({message:this.$t("message.pledgePoolNoAmount")}).then(()=>{});return}if(this.needApprove){a.approval(A,g,k((this.needAmount*this.menu).toString())).then(e=>{a.usdt().then(s=>{s.contract.on("Approval",(d,i,l)=>{console.log(to,l,from),d==a.address&&i==g&&(this.needApprove=!1)})})});return}a.pledge(this.menu).then(e=>{c({message:e.message}).then(()=>{})}).catch(e=>{console.error(e)})},take(){this.canTakeAmount!=0&&a.take().then(e=>c({message:e.message}).then(()=>{}))},transfer(){this.transferAddress!=""&&a.transfer(this.transferAddress).then(e=>c({message:e.message}).then(()=>{}))},init(){a.balanceOfPledgeAmount().then(e=>{this.poolUSDT=e}),a.pledgeCheck(this.menu).then(e=>{e==0?this.needApprove=!1:this.needApprove=!0}),a.getNeedAmount().then(e=>{this.needAmount=e}),a.getUserPledge().then(e=>{if(e&&e.createAt>0){var s=e.lastTakeAt==0?e.createAt:e.lastTakeAt,d=Math.trunc((Math.round(new Date().getTime()/1e3)-Number(s))/60),i=u(e.orgAmount)*.01*d;i>=u(e.leftAmount)&&(i=e.leftAmount),this.leftTakeAmount=u(e.leftAmount),this.canTakeAmount=i}})}},mounted(){this.init()}},$={class:"box-nft"},B={class:"content"},w={class:"background"},F={class:"boydey"},M={class:"logo"},L={class:"number"},R={class:"numberText"},V={class:"numberRight"},P={style:{color:"#ff8063"}},z={class:"menu"},H=["value","onClick"],K={class:"numberButton"},O={style:{"font-size":"12px"}},j={class:"numberText"},I=["placeholder"],q={class:"numberText"},G={style:{color:"#ff8063"}},J={class:"numberRight"},Q={style:{color:"black"}},W={style:{color:"#ff8063"}},X={class:"foot"},Y={class:"footText"},Z=["innerHTML"];function ee(e,s,d,i,l,r){const v=y("Tab");return h(),m("div",$,[b(v),t("div",B,[t("div",w,[t("div",F,[t("div",M,o(e.$t("message.textEcology_title")),1),t("div",L,[t("div",R,[t("div",null,o(e.$t("message.textEcology_left1"))+"：",1),t("div",V,[t("div",P,o(`${Number(l.poolUSDT).toFixed(2)}`),1),t("div",{class:"button",onClick:s[0]||(s[0]=n=>r.check())},o(e.$t("message.textEcology_check")),1)])]),t("div",z,[(h(!0),m(x,null,E(l.actions,(n,p)=>(h(),m("div",{key:p,value:n.value,class:N(`${this.menu===n.key?"menu1 menu2":"menu1"}`),onClick:te=>r.menuChange(n.key,n.value)},o(n.value),11,H))),128))]),t("div",K,[t("span",O," ≈ "+o(l.needAmount*this.menu)+" DragonKing",1),t("div",{class:"but_h",onClick:s[1]||(s[1]=(...n)=>r.pledge&&r.pledge(...n))},o(l.needApprove?e.$t("message.approve"):e.$t("message.textEcology_left2")),1)]),t("div",j,[C(t("input",{class:"input","onUpdate:modelValue":s[2]||(s[2]=n=>l.transferAddress=n),type:"text",placeholder:`${e.$t("message.textEcology_left4")}`},null,8,I),[[D,l.transferAddress]]),t("div",{class:"transferBut",onClick:s[3]||(s[3]=(...n)=>r.transfer&&r.transfer(...n))},o(e.$t("message.textEcology_ctransfer")),1)]),t("div",q,[t("div",null,[U(o(e.$t("message.textEcology_left3"))+"： ",1),t("span",G,o(this.leftTakeAmount)+" U",1)]),t("div",J,[t("div",Q,o(e.$t("message.textEcology_left5"))+"：",1),t("div",W,o(`${Number(this.canTakeAmount).toFixed(2)}`)+" U",1),t("div",{class:"buttonLing",onClick:s[4]||(s[4]=(...n)=>r.take&&r.take(...n))},o(e.$t("message.textEcology_down")),1)])])])])]),t("div",X,[t("div",Y,[t("div",{innerHTML:e.$t("message.textEcology")},null,8,Z)])])])])}const oe=T(S,[["render",ee],["__scopeId","data-v-410f1c6c"]]);export{oe as default};
